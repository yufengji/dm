!function(t){var e={};function a(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=e,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,a){"use strict";a(1);var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eleId=e.eleId,this.canvasId=e.canvasId,this.canvasW=e.canvasWidth,this.canvasH=e.canvasHeight,this.lineHeight=e.lineHeight,this.txtFont=e.txtFont||"",this.txtFillStyle=e.txtFillStyle||"",this.specialFont=e.specialFont||"",this.specialFillStyle=e.specialFillStyle||"",this.hideShadow=e.hideShadow||!1,this.barrageArray=[],this.barrageContain=document.getElementById(this.eleId),this.isPaused=e.isPaused||!1,this.isHide=e.isHide||!1,this.maxShowNum=e.maxShowNum||-1,this.checkLineExit(),this.createEle(),this.animate()}return t.prototype.checkLineExit=function(){this.lArray=[];for(var t=0;t<Math.floor(this.canvasH/this.lineHeight);t++)this.lArray.push(0)},t.prototype.createEle=function(){this.canvas=document.createElement("canvas"),this.canvas.id=this.canvasId,this.canvas.height=this.canvasH,this.canvas.width=this.canvasW,this.barrageContain.appendChild(this.canvas),this.context=this.canvas.getContext("2d")},t.prototype.addText=function(t){if(this.isHide)return!1;t.x=this.canvasW,t.y=-1,this.barrageArray.push(t)},t.prototype.animate=function(){var t=this,e=function a(){if(!t.isPaused&&!t.isHide){t.context.clearRect(0,0,t.canvas.width,t.canvas.height);for(var e=-1==t.maxShowNum?t.barrageArray.length:t.maxShowNum>t.barrageArray.length?t.barrageArray.length:t.maxShowNum,r=0;r<t.barrageArray.length;r++)if(r<e){var i=void 0;if(t.barrageArray[r].x-=t.barrageArray[r].speed,-1==t.barrageArray[r].y){for(var n=!1,o=0;o<t.lArray.length;o++)0!=t.lArray[o]||n||(t.barrageArray[r].y=o,t.lArray[o]=1,n=!0);if(!n){for(var s=0;s<t.lArray.length;s++)t.lArray[s]=0;t.barrageArray[r].y=0,t.lArray[0]=1}}switch(t.context.save(),t.barrageArray[r].type){case 1:t.context.font=t.barrageArray[r].txtFont||t.txtFont,t.context.fillStyle=t.barrageArray[r].txtFillStyle||t.txtFillStyle,i=t.context.measureText(t.barrageArray[r].txt).width,t.hideShadow||/Firefox/i.test(window.navigator.userAgent)||(t.context.shadowOffsetX=1,t.context.shadowOffsetY=1,t.context.shadowColor="#000",t.context.shadowBlur=4),t.context.textBaseline="middle",t.context.fillText(t.barrageArray[r].txt,t.barrageArray[r].x,t.barrageArray[r].y*t.lineHeight+30);break;case 2:t.context.font=t.barrageArray[r].txtFont||t.txtFont,t.context.fillStyle=t.barrageArray[r].txtFillStyle||t.txtFillStyle,i=t.context.measureText(t.barrageArray[r].txt).width,t.context.textBaseline="middle",t.hideShadow||/Firefox/i.test(window.navigator.userAgent)||(t.context.shadowOffsetX=1,t.context.shadowOffsetY=1,t.context.shadowColor="#000",t.context.shadowBlur=4),t.context.fillText(t.barrageArray[r].txt,t.barrageArray[r].x,t.barrageArray[r].y*t.lineHeight+30),t.context.strokeStyle=t.barrageArray[r].txtFillStyle||t.txtFillStyle,t.context.lineWidth=2,t.context.beginPath(),t.context.rect(t.barrageArray[r].x-t.barrageArray[r].boxSet.padding,t.barrageArray[r].y*t.lineHeight+30-t.barrageArray[r].boxSet.height/2,i+2*t.barrageArray[r].boxSet.padding,t.barrageArray[r].boxSet.height),t.context.stroke();break;case 3:t.context.font=t.barrageArray[r].txtFont||t.txtFont,t.context.fillStyle=t.barrageArray[r].txtFillStyle||t.txtFillStyle,i=t.context.measureText(t.barrageArray[r].txt).width,t.context.textBaseline="middle",t.context.fillText(t.barrageArray[r].txt,t.barrageArray[r].x,t.barrageArray[r].y*t.lineHeight+30);var c=new Image;c.src=t.barrageArray[r].gift.url,t.context.drawImage(c,t.barrageArray[r].x+i,t.barrageArray[r].y*t.lineHeight+30-t.barrageArray[r].gift.height/2,t.barrageArray[r].gift.width,t.barrageArray[r].gift.height),i+=t.barrageArray[r].gift.width,t.barrageArray[r].gift.num>1&&(t.context.fillText("x"+t.barrageArray[r].gift.num+"连击！",t.barrageArray[r].x+i,t.barrageArray[r].y*t.lineHeight+30),i+=t.context.measureText("x"+t.barrageArray[r].gift.num+"连击！").width)}t.context.restore(),t.canvasW-t.barrageArray[r].x-parseInt(i)!=100&&t.canvasW-t.barrageArray[r].x-parseInt(i)!=101||(t.lArray[t.barrageArray[r].y]=0),-t.barrageArray[r].x>=i+20&&t.barrageArray.splice(r,1)}}requestNextAnimationFrame(a)};requestNextAnimationFrame(e)},t.prototype.clearCanvas=function(){for(var t=0;t<this.lArray.length;t++)this.lArray[t]=0;this.barrageArray=[],this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.changesize=function(t,e){this.canvas.width=t,this.canvas.height=e,this.canvasW=t,this.canvasH=e,this.clearCanvas(),this.checkLineExit()},t}();window.Barrage=r},function(t,e,a){"use strict";window.requestNextAnimationFrame=function(){var t=undefined,e=(undefined,undefined),a=navigator.userAgent,r=0,i=this;return window.webkitRequestAnimationFrame&&(function(t){t===undefined&&(t+=new Date),i.callback(t)},t=window.webkitRequestAnimationFrame,window.webkitRequestAnimationFrame=function(a,r){i.callback=e,t(a,r)}),window.mozRequestAnimationFrame&&(r=a.indexOf("rv:"),-1!=a.indexOf("Gecko")&&"2.0"===a.substr(r+3,3)&&(window.mozRequestAnimationFrame=undefined)),window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){var a,r;window.setTimeout(function(){a=+new Date,t(a),r=+new Date,i.timeout=1e3/60-(r-a)},i.timeout)}}()}]);